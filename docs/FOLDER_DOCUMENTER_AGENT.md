# Folder Documenter Agent
## Automated Comprehensive Folder Documentation System

### Overview

The `folder-documenter` agent is a specialized documentation agent that automatically generates comprehensive README files for any folder when agents complete work within that directory. It creates detailed rundowns of folder contents, functionality, integration patterns, error handling, and kill switches.

---

## Agent Specification

**Agent ID**: `folder-documenter`  
**Trigger**: Automatic activation when any agent completes tasks in a folder  
**Purpose**: Generate comprehensive folder documentation  
**Position**: Post-task execution (reactive agent)  

### Core Responsibilities

1. **Complete Folder Analysis**
   - Map all files and their purposes
   - Identify integration patterns between files
   - Document data flows and dependencies
   - Catalog error handling mechanisms

2. **Comprehensive Documentation Generation**
   - Create detailed README.md for the folder
   - Document all functions and their relationships
   - Map integration points with rest of repository
   - Document kill switches and error pathways

3. **Living Documentation Maintenance**
   - Update documentation when folder contents change
   - Maintain version history of changes
   - Cross-reference with other folder documentation

---

## Activation Triggers

The `folder-documenter` agent is automatically spawned when:

1. **Task Completion**: Any agent marks tasks complete in a folder
2. **File Changes**: Significant file additions/modifications in a folder
3. **Integration Points**: New connections between folders are established
4. **Error Resolution**: Error handling mechanisms are added or modified
5. **Manual Request**: Human or agent explicitly requests documentation

### Activation Protocol

```yaml
Trigger Conditions:
  - Agent completes final task in folder
  - File count change >20% in folder
  - New integration patterns detected
  - Error handling patterns added
  - Manual /agents folder-documenter --path=<folder>

Activation Sequence:
  1. Wait for triggering agent to complete fully
  2. Analyze folder in current state
  3. Generate comprehensive documentation
  4. Validate documentation accuracy
  5. Update cross-references to other folders
  6. Log completion and handoff
```

---

## Documentation Generation Process

### Phase 1: Deep Folder Analysis (5-10 minutes)

```yaml
Comprehensive Scan:
  1. File Inventory:
     - List all files with purposes
     - Identify entry points and exports
     - Map configuration files
     - Catalog test files
  
  2. Functionality Mapping:
     - Document each function/class/module
     - Map data flows between files
     - Identify shared utilities
     - Document interfaces and contracts
  
  3. Integration Analysis:
     - How folder connects to rest of repo
     - External dependencies
     - Internal file relationships
     - API boundaries and contracts
  
  4. Error Handling Discovery:
     - Error handling patterns used
     - Validation and sanitization
     - Fallback mechanisms
     - Recovery procedures
  
  5. Kill Switch Identification:
     - Circuit breakers and timeouts
     - Graceful degradation points
     - Emergency shutdown procedures
     - Data consistency safeguards
```

### Phase 2: Documentation Generation (10-15 minutes)

```yaml
README.md Creation:
  1. Overview Section:
     - Folder purpose and scope
     - Key functionality summary
     - Integration role in larger system
  
  2. Architecture Section:
     - File organization and relationships
     - Data flow diagrams (text-based)
     - Key patterns and abstractions
  
  3. Component Documentation:
     - Detailed file-by-file breakdown
     - Function/class documentation
     - Interface specifications
  
  4. Integration Guide:
     - How to use this folder from outside
     - Dependencies and prerequisites
     - Configuration requirements
  
  5. Error Handling & Kill Switches:
     - All error pathways documented
     - Kill switch locations and triggers
     - Recovery and rollback procedures
  
  6. Development Guide:
     - How to add new functionality
     - Testing patterns and requirements
     - Deployment considerations
```

---

## Generated README.md Template

```markdown
# [Folder Name] Documentation
*Auto-generated by folder-documenter agent on [timestamp]*

## Overview
### Purpose
[What this folder does and why it exists]

### Scope
[What's included/excluded from this folder's responsibilities]

### Integration Role
[How this folder fits into the larger system]

---

## Architecture

### File Organization
```
folder-name/
├── index.js           # Main entry point
├── core/             # Core functionality
│   ├── engine.js     # Primary logic engine
│   └── validators.js # Input validation
├── utils/            # Shared utilities
├── tests/            # Test suite
└── README.md         # This documentation
```

### Data Flow
```
Input → Validation → Core Processing → Output
  ↓         ↓              ↓           ↓
Error   Error Log      Error Log   Error Log
  ↓         ↓              ↓           ↓
Fallback  Fallback     Fallback    Fallback
```

### Key Patterns
- **Pattern 1**: [Description and usage]
- **Pattern 2**: [Description and usage]
- **Error Handling**: [Primary error handling approach]

---

## Component Documentation

### Core Components

#### [Component Name] (`filename.js`)
**Purpose**: [What this component does]
**Exports**: [List of exported functions/classes]
**Dependencies**: [Internal and external dependencies]

**Key Functions**:
- `functionName()` - [Description, parameters, return value]
- `anotherFunction()` - [Description, parameters, return value]

**Error Handling**:
- Validates input parameters
- Throws `ValidationError` for invalid inputs
- Falls back to default values on minor errors
- Logs all errors to system logger

**Integration Points**:
- Called by: [List of components that use this]
- Calls: [List of components this uses]
- Events: [Events emitted/consumed]

#### [Next Component] (`filename.js`)
[Same structure as above]

### Utility Components

#### [Utility Name] (`utils/filename.js`)
**Purpose**: [Shared functionality description]
**Used By**: [List of components using this utility]

---

## Integration Guide

### Using This Folder

#### As a Dependency
```javascript
// Import the main interface
const folderApi = require('./folder-name');

// Use primary functions
const result = await folderApi.primaryFunction(params);
```

#### Configuration Requirements
```javascript
// Required environment variables
FOLDER_CONFIG_URL=http://localhost:3000
FOLDER_API_KEY=your-api-key

// Optional configuration
FOLDER_TIMEOUT=5000
FOLDER_RETRY_ATTEMPTS=3
```

### Dependencies
- **External**: [List external npm packages, APIs, services]
- **Internal**: [List other folders/modules this depends on]
- **System**: [System requirements like databases, file systems]

### Prerequisites
1. [Required setup step 1]
2. [Required setup step 2]
3. [Required setup step 3]

---

## Error Handling & Kill Switches

### Error Categories

#### Validation Errors
- **Trigger**: Invalid input parameters
- **Response**: Throw `ValidationError` with details
- **Recovery**: Return to caller with error context
- **Logging**: Log at WARN level

#### Processing Errors
- **Trigger**: Core logic failures
- **Response**: Attempt retry with exponential backoff
- **Recovery**: Fall back to cached results or defaults
- **Logging**: Log at ERROR level

#### System Errors
- **Trigger**: External dependency failures
- **Response**: Activate circuit breaker
- **Recovery**: Graceful degradation mode
- **Logging**: Log at CRITICAL level

### Kill Switches

#### Emergency Shutdown (`killSwitch.emergency()`)
- **Location**: `core/killswitch.js:15`
- **Trigger**: Critical system failure detected
- **Action**: Immediately halt all processing
- **Data Safety**: Flush pending operations to storage
- **Notification**: Alert monitoring systems

#### Graceful Degradation (`killSwitch.degrade()`)
- **Location**: `core/killswitch.js:42`
- **Trigger**: Performance degradation detected
- **Action**: Disable non-essential features
- **Fallback**: Switch to read-only mode
- **Recovery**: Auto-recovery when metrics improve

#### Circuit Breaker (`killSwitch.breakCircuit()`)
- **Location**: `utils/circuitbreaker.js:28`
- **Trigger**: Dependency failure rate >20%
- **Action**: Stop calling failed dependency
- **Fallback**: Use cached data or alternative service
- **Recovery**: Test dependency every 60 seconds

### Recovery Procedures

#### Automatic Recovery
1. **Detection**: Health checks every 30 seconds
2. **Validation**: Confirm system stability for 5 minutes
3. **Gradual Activation**: Re-enable features incrementally
4. **Monitoring**: Enhanced logging for 24 hours

#### Manual Recovery
```bash
# Check system health
npm run health-check

# Reset circuit breakers
npm run reset-circuits

# Gradual restart
npm run restart --mode=gradual

# Full system restart
npm run restart --mode=full
```

---

## Development Guide

### Adding New Functionality

1. **Create Component**: Add new file in appropriate subfolder
2. **Follow Patterns**: Use existing error handling and logging
3. **Add Tests**: Minimum 80% coverage required
4. **Update Integration**: Modify main index.js if needed
5. **Document Changes**: Update this README

### Testing

#### Running Tests
```bash
# Run all tests
npm test

# Run specific test file
npm test -- filename.test.js

# Run with coverage
npm run test:coverage
```

#### Test Structure
- Unit tests in `tests/unit/`
- Integration tests in `tests/integration/`
- Error scenario tests in `tests/errors/`
- Performance tests in `tests/performance/`

### Deployment Considerations

- **Environment**: [Specific environment requirements]
- **Resources**: [Memory, CPU, storage requirements]
- **Scaling**: [How this folder scales with load]
- **Monitoring**: [Key metrics to monitor]

---

## Cross-Folder Relationships

### Upstream Dependencies
- **[Folder A]**: Provides configuration and initialization
- **[Folder B]**: Supplies data validation services
- **[Folder C]**: Handles authentication and authorization

### Downstream Consumers  
- **[Folder X]**: Uses our API for data processing
- **[Folder Y]**: Integrates with our event system
- **[Folder Z]**: Depends on our utility functions

### Shared Resources
- **Database**: [Shared tables/collections]
- **Cache**: [Shared cache keys/patterns]
- **Events**: [Shared event types]
- **Configuration**: [Shared config values]

---

## Maintenance & Updates

### Regular Maintenance
- **Weekly**: Check error logs and performance metrics
- **Monthly**: Review and update dependencies
- **Quarterly**: Full code review and optimization
- **Annually**: Architecture review and refactoring

### Update Procedures
1. **Backup**: Create backup of current state
2. **Test**: Run full test suite
3. **Deploy**: Use gradual deployment strategy  
4. **Monitor**: Enhanced monitoring for 48 hours
5. **Rollback**: Immediate rollback if issues detected

---

## Troubleshooting

### Common Issues

#### Issue: [Common Problem 1]
- **Symptoms**: [How to identify this issue]
- **Cause**: [Root cause explanation]
- **Solution**: [Step-by-step fix]
- **Prevention**: [How to avoid in future]

#### Issue: [Common Problem 2]
- **Symptoms**: [How to identify this issue]
- **Cause**: [Root cause explanation]  
- **Solution**: [Step-by-step fix]
- **Prevention**: [How to avoid in future]

### Emergency Contacts
- **Primary**: [Team/person responsible for this folder]
- **Secondary**: [Backup contact]
- **Escalation**: [When to escalate and to whom]

---

## Metrics & Monitoring

### Key Performance Indicators
- **Performance**: Response time <100ms (p95)
- **Reliability**: Uptime >99.9%
- **Error Rate**: <0.1% of all operations
- **Resource Usage**: <500MB memory, <10% CPU

### Monitoring Dashboards
- **System Health**: [Link to monitoring dashboard]
- **Performance Metrics**: [Link to performance dashboard]  
- **Error Tracking**: [Link to error monitoring]
- **Usage Analytics**: [Link to usage dashboard]

---

## Change Log

### Recent Changes
- **[Date]**: [Description of change and agent responsible]
- **[Date]**: [Description of change and agent responsible]
- **[Date]**: [Description of change and agent responsible]

### Documentation Updates
- **[Date]**: Initial documentation generated by folder-documenter agent
- **[Date]**: Updated integration section after [specific change]
- **[Date]**: Added new error handling patterns

---

*This documentation is automatically maintained by the folder-documenter agent. Last updated: [timestamp]*
*For questions about this folder, consult the change log or contact the development team.*
```

---

## Integration with Agent System

### Agent Header Protocol Compliance

The `folder-documenter` follows the universal agent protocol:

```yaml
1. Read PROJECT_MANIFESTO.md - Align documentation style with project values
2. Read PROJECT_LOG.md - Understand recent changes and context
3. Read session journal - Check for any special documentation requirements
4. Log activation - Record start of documentation generation
5. Analyze folder - Deep scan of all contents
6. Generate documentation - Create comprehensive README.md
7. Validate accuracy - Cross-check documentation against actual code
8. Update cross-references - Link with other folder documentation
9. Log completion - Record successful documentation generation
```

### Cross-Agent Coordination

```yaml
Coordination Points:
  - task-executor: Triggers folder-documenter when tasks complete
  - error-manager: Provides error handling patterns to document
  - foundation-architect: Ensures documentation follows architectural patterns
  - vertical-slice-builder: Documents how folder fits into critical paths
  - journal-keeper: Records documentation generation in project journal
```

---

## Quality Standards

### Documentation Quality Gates
- [ ] All files in folder documented
- [ ] All functions/classes described  
- [ ] Integration points mapped
- [ ] Error handling documented
- [ ] Kill switches identified
- [ ] Recovery procedures defined
- [ ] Cross-references validated
- [ ] Examples provided where appropriate

### Accuracy Validation
- [ ] Code analysis matches documentation
- [ ] Integration patterns verified
- [ ] Error pathways tested
- [ ] Kill switches functional
- [ ] Recovery procedures validated
- [ ] Cross-folder relationships confirmed

---

## Success Criteria

A successful folder documentation provides:
1. **Complete Understanding** - Anyone can understand the folder's purpose
2. **Integration Clarity** - Clear how to use/integrate with this folder
3. **Error Transparency** - All failure modes and recovery paths documented
4. **Maintenance Guide** - Clear guidance for future modifications
5. **Emergency Procedures** - Kill switches and recovery procedures accessible
6. **Cross-System Context** - Understanding of folder's role in larger system

The documentation should enable both humans and other agents to work effectively with the folder contents while maintaining system integrity and enabling quick issue resolution.